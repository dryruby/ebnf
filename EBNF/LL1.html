<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: EBNF::LL1
  
    &mdash; EBNF parser and parser generator
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "EBNF::LL1";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (L)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../EBNF.html" title="EBNF (module)">EBNF</a></span></span>
     &raquo; 
    <span class="title">LL1</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: EBNF::LL1
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="Base.html" title="EBNF::Base (class)">Base</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ebnf/ll1.rb<span class="defines">,<br />
  lib/ebnf/ll1/lexer.rb,<br /> lib/ebnf/ll1/parser.rb,<br /> lib/ebnf/ll1/scanner.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This module extends <span class='object_link'><a href="Base.html" title="EBNF::Base (class)">Base</a></span> to create metadata including <em>branch</em>, First/Follow[https://en.wikipedia.org/wiki/LL_parser#Constructing_an_LL.281.29_parsing_table], and other tables which is used by <span class='object_link'><a href="LL1/Parser.html" title="EBNF::LL1::Parser (module)">Parser</a></span> to recognize examples of the associated grammar.</p>

<p>Branch Table</p>

<p>The Branch table is a hash mapping production rules to a hash relating terminals appearing in input to sequence of productions to follow when the corresponding input terminal is found. This allows either the <code>seq</code> primitive, where all terminals map to the same sequence of productions, or the <code>alt</code> primitive, where each terminal may map to a different production.</p>

<pre class="code ruby"><code class="ruby"> BRANCH = {
   :alt =&gt; {
     &quot;(&quot; =&gt; [:seq, :_alt_1],
     :HEX =&gt; [:seq, :_alt_1],
     :O_RANGE =&gt; [:seq, :_alt_1],
     :RANGE =&gt; [:seq, :_alt_1],
     :STRING1 =&gt; [:seq, :_alt_1],
     :STRING2 =&gt; [:seq, :_alt_1],
     :SYMBOL =&gt; [:seq, :_alt_1],
   },
   ...
   :declaration =&gt; {
     &quot;@pass&quot; =&gt; [:pass],
     &quot;@terminals&quot; =&gt; [&quot;@terminals&quot;],
   },
   ...
 }
</code></pre>

<p>In this case the <code>alt</code> rule is <code>seq (&#39;|&#39; seq)*</code> can happen when any of the specified tokens appears on the input stream. The all cause the same token to be passed to the <code>seq</code> rule and follow with <code>_alt_1</code>, which handles the <code>(&#39;|&#39; seq)*</code> portion of the rule, after the first sequence is matched.</p>

<p>The <code>declaration</code> rule is <code>@terminals&#39; | pass</code> using the <code>alt</code> primitive determining the production to run based on the terminal appearing on the input stream. Eventually, a terminal production is found and the token is consumed.</p>

<p>First/Follow Table</p>

<p>The <a href="https://en.wikipedia.org/wiki/LL_parser#Constructing_an_LL.281.29_parsing_table">First/Follow</a> table is a hash mapping production rules to the terminals that may proceed or follow the rule. For example:</p>

<pre class="code ruby"><code class="ruby"> FIRST = {
   :alt =&gt; [
     :HEX,
     :SYMBOL,
     :RANGE,
     :O_RANGE,
     :STRING1,
     :STRING2,
     &quot;(&quot;],
   ...
 }
</code></pre>

<p>Terminals Table</p>

<p>This table is a simple list of the terminal productions found in the grammar. For example:</p>

<pre class="code ruby"><code class="ruby"> <span class='const'>TERMINALS</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@pass</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@terminals</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:HEX</span><span class='comma'>,</span> <span class='symbol'>:LHS</span><span class='comma'>,</span> <span class='symbol'>:O_RANGE</span><span class='comma'>,</span><span class='symbol'>:POSTFIX</span><span class='comma'>,</span>
   <span class='symbol'>:RANGE</span><span class='comma'>,</span> <span class='symbol'>:STRING1</span><span class='comma'>,</span> <span class='symbol'>:STRING2</span><span class='comma'>,</span> <span class='symbol'>:SYMBOL</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='tstring_end'>&quot;</span></span>
 <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
</code></pre>

<p>Cleanup Table</p>

<p>This table identifies productions which used EBNF rules, which are transformed to BNF for actual parsing. This allows the parser, in some cases, to reproduce <em>star</em>, <em>plus</em>, and <em>opt</em> rule matches. For example:</p>

<pre class="code ruby"><code class="ruby"> <span class='const'>CLEANUP</span> <span class='op'>=</span> <span class='lbrace'>{</span>
   <span class='symbol'>:_alt_1</span> <span class='op'>=&gt;</span> <span class='symbol'>:star</span><span class='comma'>,</span>
   <span class='symbol'>:_alt_3</span> <span class='op'>=&gt;</span> <span class='symbol'>:merge</span><span class='comma'>,</span>
   <span class='symbol'>:_diff_1</span> <span class='op'>=&gt;</span> <span class='symbol'>:opt</span><span class='comma'>,</span>
   <span class='symbol'>:ebnf</span> <span class='op'>=&gt;</span> <span class='symbol'>:star</span><span class='comma'>,</span>
   <span class='symbol'>:_ebnf_2</span> <span class='op'>=&gt;</span> <span class='symbol'>:merge</span><span class='comma'>,</span>
   <span class='symbol'>:_postfix_1</span> <span class='op'>=&gt;</span> <span class='symbol'>:opt</span><span class='comma'>,</span>
   <span class='symbol'>:seq</span> <span class='op'>=&gt;</span> <span class='symbol'>:plus</span><span class='comma'>,</span>
   <span class='symbol'>:_seq_1</span> <span class='op'>=&gt;</span> <span class='symbol'>:star</span><span class='comma'>,</span>
   <span class='symbol'>:_seq_2</span> <span class='op'>=&gt;</span> <span class='symbol'>:merge</span><span class='comma'>,</span>
 <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
</code></pre>

<p>In this case the <code>ebnf</code> rule was <code>(declaration | rule)*</code>. As BNF does not support a star operator, this is decomposed into a set of rules using <code>alt</code> and <code>seq</code> primitives:</p>

<pre class="code ruby"><code class="ruby"> ebnf    ::= _empty _ebnf_2
 _ebnf_1 ::= declaration | rule
 _ebnf_2 ::= _ebnf_1 ebnf
 _ebnf_3 ::= ebnf
</code></pre>

<p>The <code>_empty</code> production matches an empty string, so allows for now value. <code>_ebnf_2</code> matches <code>declaration | rule</code> (using the <code>alt</code> primitive) followed by <code>ebnf</code>, creating a sequence of zero or more <code>declaration</code> or <code>alt</code> members.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="LL1/Parser.html" title="EBNF::LL1::Parser (module)">Parser</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="LL1/Lexer.html" title="EBNF::LL1::Lexer (class)">Lexer</a></span>, <span class='object_link'><a href="LL1/Scanner.html" title="EBNF::LL1::Scanner (class)">Scanner</a></span>
    
  
</p>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#branch-instance_method" title="#branch (instance method)">#<strong>branch</strong>  &#x21d2; Hash{Symbol =&gt; Hash{String, Symbol =&gt; Array&lt;Symbol&gt;}} </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Branch table, represented as a recursive hash.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#cleanup-instance_method" title="#cleanup (instance method)">#<strong>cleanup</strong>  &#x21d2; Hash{Symbol =&gt; Symbol} </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>EBNF Cleanup table.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#first-instance_method" title="#first (instance method)">#<strong>first</strong>  &#x21d2; Hash{Symbol =&gt; Array&lt;String, Symbol&gt;} </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>First table.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#follow-instance_method" title="#follow (instance method)">#<strong>follow</strong>  &#x21d2; Hash{Symbol =&gt; Array&lt;String, Symbol&gt;} </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Follow table.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#pass-instance_method" title="#pass (instance method)">#<strong>pass</strong>  &#x21d2; Symbol, String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pass expression.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">#<strong>start</strong>  &#x21d2; Symbol </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Start symbol.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#terminals-instance_method" title="#terminals (instance method)">#<strong>terminals</strong>  &#x21d2; Array&lt;String, Symbol&gt; </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Terminal table.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_tables-instance_method" title="#build_tables (instance method)">#<strong>build_tables</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate parser tables, <span class='object_link'><a href="#branch-instance_method" title="EBNF::LL1#branch (method)">#branch</a></span>, <span class='object_link'><a href="#first-instance_method" title="EBNF::LL1#first (method)">#first</a></span>, <span class='object_link'><a href="#follow-instance_method" title="EBNF::LL1#follow (method)">#follow</a></span>, and <span class='object_link'><a href="#terminals-instance_method" title="EBNF::LL1#terminals (method)">#terminals</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#first_follow-instance_method" title="#first_follow (instance method)">#<strong>first_follow</strong>(*starts)  &#x21d2; EBNF </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create first/follow for each rule using techniques defined for LL(1) parsers.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#outputTable-instance_method" title="#outputTable (instance method)">#<strong>outputTable</strong>(io, name, table, indent = 0)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate an output table in Ruby format.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_ruby_ll1-instance_method" title="#to_ruby_ll1 (instance method)">#<strong>to_ruby_ll1</strong>(output, **options)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Output Ruby parser files for LL(1) parsing.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="branch-instance_method">
  
    #<strong>branch</strong>  &#x21d2; <tt>Hash{Symbol =&gt; Hash{String, Symbol =&gt; Array&lt;Symbol&gt;}}</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Branch table, represented as a recursive hash. The table is indexed by rule symbol, which in-turn references a hash of terminals (which are the first terminals of the production), which in turn reference the sequence of rules that follow, given that terminal as input</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Hash{String, Symbol =&gt; Array&lt;Symbol&gt;}}</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 93</span>

<span class='kw'>def</span> <span class='id identifier rubyid_branch'>branch</span>
  <span class='ivar'>@branch</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="cleanup-instance_method">
  
    #<strong>cleanup</strong>  &#x21d2; <tt>Hash{Symbol =&gt; Symbol}</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>EBNF Cleanup table</p>

<p>The list of terminals used in the grammar.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Symbol}</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 110</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup'>cleanup</span>
  <span class='ivar'>@cleanup</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="first-instance_method">
  
    #<strong>first</strong>  &#x21d2; <tt>Hash{Symbol =&gt; Array&lt;String, Symbol&gt;}</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>First table</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Array&lt;String, Symbol&gt;}</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_first'>first</span>
  <span class='ivar'>@first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="follow-instance_method">
  
    #<strong>follow</strong>  &#x21d2; <tt>Hash{Symbol =&gt; Array&lt;String, Symbol&gt;}</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Follow table</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Array&lt;String, Symbol&gt;}</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_follow'>follow</span>
  <span class='ivar'>@follow</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="pass-instance_method">
  
    #<strong>pass</strong>  &#x21d2; <tt>Symbol</tt>, <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Pass expression</p>

<p>A Terminal symbol used for skipping whitespace and comments</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>, <tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pass'>pass</span>
  <span class='ivar'>@pass</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    #<strong>start</strong>  &#x21d2; <tt>Symbol</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Start symbol</p>

<p>The rule which starts the grammar</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 131</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span>
  <span class='ivar'>@start</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="terminals-instance_method">
  
    #<strong>terminals</strong>  &#x21d2; <tt>Array&lt;String, Symbol&gt;</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Terminal table</p>

<p>The list of terminals used in the grammar.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 117</span>

<span class='kw'>def</span> <span class='id identifier rubyid_terminals'>terminals</span>
  <span class='ivar'>@terminals</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="build_tables-instance_method">
  
    #<strong>build_tables</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate parser tables, <span class='object_link'><a href="#branch-instance_method" title="EBNF::LL1#branch (method)">#branch</a></span>, <span class='object_link'><a href="#first-instance_method" title="EBNF::LL1#first (method)">#first</a></span>, <span class='object_link'><a href="#follow-instance_method" title="EBNF::LL1#follow (method)">#follow</a></span>, and <span class='object_link'><a href="#terminals-instance_method" title="EBNF::LL1#terminals (method)">#terminals</a></span></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 295</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_tables'>build_tables</span>
  <span class='id identifier rubyid_progress'>progress</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>build_tables</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Terminals: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_terminal?'>terminal?</span><span class='rbrace'>}</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Non-Terminals: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_rule?'>rule?</span><span class='rbrace'>}</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbrace'>}</span>

  <span class='ivar'>@first</span> <span class='op'>=</span> <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span>
    <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:first</span><span class='rparen'>)</span><span class='period'>.</span>
    <span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_memo'>memo</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='op'>|</span>
      <span class='id identifier rubyid_memo'>memo</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='ivar'>@follow</span> <span class='op'>=</span> <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span>
    <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:follow</span><span class='rparen'>)</span><span class='period'>.</span>
    <span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_memo'>memo</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='op'>|</span>
      <span class='id identifier rubyid_memo'>memo</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>

  <span class='ivar'>@cleanup</span> <span class='op'>=</span> <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span>
    <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:cleanup</span><span class='rparen'>)</span><span class='period'>.</span>
    <span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_memo'>memo</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_memo'>memo</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_cleanup'>cleanup</span><span class='rparen'>)</span><span class='rbrace'>}</span>

  <span class='ivar'>@terminals</span> <span class='op'>=</span> <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  <span class='ivar'>@terminals</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='ivar'>@terminals</span> <span class='op'>-</span> <span class='lbracket'>[</span><span class='symbol'>:_eps</span><span class='comma'>,</span> <span class='symbol'>:_eof</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^_</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='comment'># FIXME: assumes that this is a (seq :PASS), or similar
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_pass'>pass</span> <span class='op'>=</span> <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_pass?'>pass?</span><span class='rbrace'>}</span>
    <span class='ivar'>@pass</span> <span class='op'>=</span> <span class='id identifier rubyid_pass'>pass</span><span class='period'>.</span><span class='id identifier rubyid_expr'>expr</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>

  <span class='comment'># If a generated terminal is found, this indicates an error, as this version does not automatically generate regular expressions for automatic terminals
</span>  <span class='ivar'>@terminals</span><span class='period'>.</span>
    <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span>
    <span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_pass_</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span>  <span class='comment'># Concession to backwards compatibility
</span>    <span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_term'>term</span><span class='op'>|</span>

    <span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>build_tables</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>terminal </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_term'>term</span><span class='embexpr_end'>}</span><span class='tstring_content'> is automatically generated; </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>regular expressions are not yet generated and parsing </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is not supported</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@branch</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@already</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@agenda</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='const'>Array</span><span class='lparen'>(</span><span class='ivar'>@starts</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_start'>start</span><span class='op'>|</span>
    <span class='id identifier rubyid_do_production'>do_production</span><span class='lparen'>(</span><span class='id identifier rubyid_start'>start</span><span class='rparen'>)</span>
    <span class='kw'>while</span> <span class='op'>!</span><span class='ivar'>@agenda</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_x'>x</span> <span class='op'>=</span> <span class='ivar'>@agenda</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
      <span class='id identifier rubyid_do_production'>do_production</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@errors</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_progress'>progress</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>###### FAILED with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> errors.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='ivar'>@errors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_progress'>progress</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Table creation failed with errors</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_progress'>progress</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ok for predictive parsing</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="first_follow-instance_method">
  
    #<strong>first_follow</strong>(*starts)  &#x21d2; <tt><span class='object_link'><a href="../EBNF.html" title="EBNF (module)">EBNF</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create first/follow for each rule using techniques defined for LL(1) parsers.</p>

<p>This takes rules which have transformed into BNF and adds first/follow and otehr information to the rules to allow the generation of metadata tables used for driving a parser.</p>

<p>Given an initial rule in EBNF:</p>

<pre class="code ruby"><code class="ruby">(rule enbf &quot;1&quot; (star declaration rule))
</code></pre>

<p>The BNF transformation becomes:</p>

<pre class="code ruby"><code class="ruby">(rule ebnf &quot;1&quot; (alt _empty _ebnf_2))
(rule _ebnf_1 &quot;1.1&quot; (alt declaration rule))
(rule _ebnf_2 &quot;1.2&quot; (seq _ebnf_1 ebnf))
(rule _ebnf_3 &quot;1.3&quot; (seq ebnf))
</code></pre>

<p>After running this method, the rules are annotated with first/follow and cleanup rules:</p>

<pre class="code ruby"><code class="ruby">(rule ebnf &quot;1&quot;
 (start #t)
 (first &quot;@pass&quot; &quot;@terminals&quot; LHS _eps)
 (follow _eof)
 (cleanup star)
 (alt _empty _ebnf_2))
(rule _ebnf_1 &quot;1.1&quot;
 (first &quot;@pass&quot; &quot;@terminals&quot; LHS)
 (follow &quot;@pass&quot; &quot;@terminals&quot; LHS _eof)
 (alt declaration rule))
(rule _ebnf_2 &quot;1.2&quot;
 (first &quot;@pass&quot; &quot;@terminals&quot; LHS)
 (follow _eof)
 (cleanup merge)
 (seq _ebnf_1 ebnf))
(rule _ebnf_3 &quot;1.3&quot; (first &quot;@pass&quot; &quot;@terminals&quot; LHS _eps) (follow _eof) (seq ebnf))
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>starts</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Set of symbols which are start rules</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../EBNF.html" title="EBNF (module)">EBNF</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>self</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://en.wikipedia.org/wiki/LL_parser#Constructing_an_LL.281.29_parsing_table" target="_parent" title="https://en.wikipedia.org/wiki/LL_parser#Constructing_an_LL.281.29_parsing_table">https://en.wikipedia.org/wiki/LL_parser#Constructing_an_LL.281.29_parsing_table</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 172</span>

<span class='kw'>def</span> <span class='id identifier rubyid_first_follow'>first_follow</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_starts'>starts</span><span class='rparen'>)</span>
  <span class='comment'># Add _eof to follow all start rules
</span>  <span class='ivar'>@starts</span> <span class='op'>=</span> <span class='id identifier rubyid_starts'>starts</span>
  <span class='kw'>if</span> <span class='ivar'>@start</span> <span class='op'>=</span> <span class='id identifier rubyid_starts'>starts</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_starts'>starts</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_start'>start</span><span class='op'>|</span>
      <span class='id identifier rubyid_start_rule'>start_rule</span> <span class='op'>=</span> <span class='id identifier rubyid_find_rule'>find_rule</span><span class='lparen'>(</span><span class='id identifier rubyid_start'>start</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No rule found for start symbol </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_start'>start</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_start_rule'>start_rule</span>
      <span class='id identifier rubyid_start_rule'>start_rule</span><span class='period'>.</span><span class='id identifier rubyid_add_follow'>add_follow</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:_eof</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_start_rule'>start_rule</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Comprehnsion rule, create shorter versions of all non-terminal sequences. This is necessary as the FF rules reference w&#39;, which is a comprehension.
</span>  <span class='id identifier rubyid_comprehensions'>comprehensions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_ittr'>ittr</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_depth'>depth</span> <span class='kw'>do</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_comprehensions'>comprehensions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_rule?'>rule?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_seq?'>seq?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_expr'>expr</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>2</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
        <span class='id identifier rubyid_new_expr'>new_expr</span> <span class='op'>=</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_expr'>expr</span><span class='lbracket'>[</span><span class='int'>2</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span><span class='lparen'>(</span><span class='symbol'>:seq</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_new_rule'>new_rule</span> <span class='op'>=</span> <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_expr'>expr</span> <span class='op'>==</span> <span class='id identifier rubyid_new_expr'>new_expr</span><span class='rbrace'>}</span>
          <span class='comment'># Link to existing comprehension used for another rules
</span>          <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FF.c</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) link comprehension rule for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_rule'>new_rule</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_expr'>new_expr</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_new_rule'>new_rule</span> <span class='op'>=</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='id identifier rubyid_new_expr'>new_expr</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FF.c</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add comprehension rule for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_rule'>new_rule</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_expr'>new_expr</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
          <span class='id identifier rubyid_comprehensions'>comprehensions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_rule'>new_rule</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span> <span class='op'>=</span> <span class='id identifier rubyid_new_rule'>new_rule</span>
      <span class='kw'>end</span>

      <span class='ivar'>@ast</span> <span class='op'>+=</span> <span class='id identifier rubyid_comprehensions'>comprehensions</span>
      <span class='id identifier rubyid_progress'>progress</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FF.c</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) comprehensions </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_comprehensions'>comprehensions</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
      <span class='id identifier rubyid_ittr'>ittr</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span> <span class='kw'>while</span> <span class='op'>!</span><span class='id identifier rubyid_comprehensions'>comprehensions</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_ittr'>ittr</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_firsts'>firsts</span><span class='comma'>,</span> <span class='id identifier rubyid_follows'>follows</span> <span class='op'>=</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span>
      <span class='comment'># add Fi(wi) to Fi(Ai) for every rule Ai → wi
</span>      <span class='comment'>#
</span>      <span class='comment'># * For sequences, this is the first rule in the sequence.
</span>      <span class='comment'># * For alts, this is every rule in the sequence
</span>      <span class='comment'># * Other rules don&#39;t matter, as they don&#39;t appear in strict BNF
</span>      <span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='symbol'>:rule</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ai'>ai</span><span class='op'>|</span>
        <span class='comment'># Fi(a w&#39; ) = { a } for every terminal a
</span>        <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_terminals'>terminals</span><span class='lparen'>(</span><span class='id identifier rubyid_ast'>ast</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span>
          <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fi.2.1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add terminal </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_t'>t</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
          <span class='id identifier rubyid_firsts'>firsts</span> <span class='op'>+=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_add_first'>add_first</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_t'>t</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_non_terminals'>non_terminals</span><span class='lparen'>(</span><span class='id identifier rubyid_ast'>ast</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span>
          <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_first_includes_eps?'>first_includes_eps?</span>
            <span class='comment'># Fi(A w&#39; ) = Fi(A) for every nonterminal A with ε not in Fi(A)
</span>            <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fi.2.2</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add first from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
            <span class='id identifier rubyid_firsts'>firsts</span> <span class='op'>+=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_add_first'>add_first</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
          <span class='kw'>else</span>
            <span class='comment'># Fi(A w&#39; ) = Fi(A) \ { ε } ∪ Fi(w&#39; ) for every nonterminal A with ε in Fi(A)
</span>            <span class='kw'>if</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_seq?'>seq?</span>
              <span class='comment'># w&#39; is either comprehnsion of ai, or empty, if there is no comprehension
</span>              <span class='id identifier rubyid_comp'>comp</span> <span class='op'>=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span> <span class='op'>||</span> <span class='id identifier rubyid_find_rule'>find_rule</span><span class='lparen'>(</span><span class='symbol'>:_empty</span><span class='rparen'>)</span>

              <span class='id identifier rubyid_fi'>fi</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>-</span> <span class='lbracket'>[</span><span class='symbol'>:_eps</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
              <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fi.2.3a</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add first </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_fi'>fi</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> and </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
              <span class='id identifier rubyid_firsts'>firsts</span> <span class='op'>+=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_add_first'>add_first</span><span class='lparen'>(</span><span class='id identifier rubyid_fi'>fi</span><span class='rparen'>)</span>
            <span class='kw'>else</span>
              <span class='comment'># ai is an alt, so there are no comprehensions of non-terminals, add Fi(A) including ε
</span>              <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fi.2.3b</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add first </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
              <span class='id identifier rubyid_firsts'>firsts</span> <span class='op'>+=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_add_first'>add_first</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='comment'># # Fi(ε) = { ε }
</span>      <span class='comment'># Add _eps as a first of _empty
</span>      <span class='id identifier rubyid_find_rule'>find_rule</span><span class='lparen'>(</span><span class='symbol'>:_empty</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_add_first'>add_first</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='symbol'>:_eps</span><span class='rbracket'>]</span><span class='rparen'>)</span>

      <span class='comment'># Add follows
</span>      <span class='comment'># if there is a rule of the form Aj → wAiw&#39; , then
</span>      <span class='comment'># First do this for the case when Ai is the first rule
</span>      <span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='symbol'>:rule</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_aj'>aj</span><span class='op'>|</span>
        <span class='id identifier rubyid_comp'>comp</span> <span class='op'>=</span> <span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span> <span class='op'>||</span> <span class='id identifier rubyid_find_rule'>find_rule</span><span class='lparen'>(</span><span class='symbol'>:_empty</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_non_terminals'>non_terminals</span><span class='lparen'>(</span><span class='id identifier rubyid_ast'>ast</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span> <span class='op'>==</span> <span class='symbol'>:_empty</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ai'>ai</span><span class='op'>|</span>
          <span class='comment'># if the terminal a is in Fi(w&#39; ), then add a to Fo(Ai)
</span>          <span class='comment'># Basically, this says that the firsts of a comprehension of a rule are the follows of the first non-terminal in the rule.
</span>          <span class='kw'>if</span> <span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
            <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fo.2.1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add follow </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
            <span class='id identifier rubyid_follows'>follows</span> <span class='op'>+=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_add_follow'>add_follow</span><span class='lparen'>(</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span>
          <span class='kw'>end</span>

          <span class='comment'># If there is no comprehension of this rule (meaning, it is a sequence of one non-terminal), then the follows of the non-terminal include the follows of the rule. This handles rules with multiple sequences because it will have a comprehension that includes the last element in the sequence
</span>          <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span>
            <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fo.2.1a</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add follow </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
            <span class='id identifier rubyid_follows'>follows</span> <span class='op'>+=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_add_follow'>add_follow</span><span class='lparen'>(</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='rparen'>)</span>
          <span class='kw'>end</span>

          <span class='comment'># if ε is in Fi(w&#39; ), then add Fo(Aj) to Fo(Ai)
</span>          <span class='kw'>if</span> <span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_first_includes_eps?'>first_includes_eps?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span>
            <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fo.2.2</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add follow </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
            <span class='id identifier rubyid_follows'>follows</span> <span class='op'>+=</span> <span class='id identifier rubyid_ai'>ai</span><span class='period'>.</span><span class='id identifier rubyid_add_follow'>add_follow</span><span class='lparen'>(</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='rparen'>)</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='comment'># Since the rules are of the form wAiw&#39;, and we&#39;ve handled the case which is just Aiw&#39;, this leaves those cases that have rules prior to Ai. This basically says that the follows of a rule are added to the follows of the comprehension of the rule
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span>
          <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fo.2.3</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) add follow </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_content'> to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_sym'>sym</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
          <span class='id identifier rubyid_follows'>follows</span> <span class='op'>+=</span> <span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_comp'>comp</span><span class='period'>.</span><span class='id identifier rubyid_add_follow'>add_follow</span><span class='lparen'>(</span><span class='id identifier rubyid_aj'>aj</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_progress'>progress</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>first_follow</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ittr'>ittr</span><span class='embexpr_end'>}</span><span class='tstring_content'>) firsts </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_firsts'>firsts</span><span class='embexpr_end'>}</span><span class='tstring_content'>, follows </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_follows'>follows</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
      <span class='id identifier rubyid_ittr'>ittr</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span> <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_firsts'>firsts</span> <span class='op'>+</span> <span class='id identifier rubyid_follows'>follows</span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span>

    <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Fi.2-post: non-terminals without first</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:terminal?</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:sym</span><span class='rparen'>)</span>
    <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_ast'>ast</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:terminal?</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="outputTable-instance_method">
  
    #<strong>outputTable</strong>(io, name, table, indent = 0)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate an output table in Ruby format</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>io</span>
      
      
        <span class='type'>(<tt>IO</tt>, <tt>StringIO</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>of the table constant</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>table</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>to output, one of <span class='object_link'><a href="#branch-instance_method" title="EBNF::LL1#branch (method)">#branch</a></span>, <span class='object_link'><a href="#first-instance_method" title="EBNF::LL1#first (method)">#first</a></span>, <span class='object_link'><a href="#follow-instance_method" title="EBNF::LL1#follow (method)">#follow</a></span>, <span class='object_link'><a href="#cleanup-instance_method" title="EBNF::LL1#cleanup (method)">#cleanup</a></span> or <span class='object_link'><a href="#terminals-instance_method" title="EBNF::LL1#terminals (method)">#terminals</a></span></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>indent</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>= 0</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 361</span>

<span class='kw'>def</span> <span class='id identifier rubyid_outputTable'>outputTable</span><span class='lparen'>(</span><span class='id identifier rubyid_io'>io</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_table'>table</span><span class='comma'>,</span> <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ind0'>ind0</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span>
  <span class='id identifier rubyid_ind1'>ind1</span> <span class='op'>=</span> <span class='id identifier rubyid_ind0'>ind0</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_ind2'>ind2</span> <span class='op'>=</span> <span class='id identifier rubyid_ind1'>ind1</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind0'>ind0</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> = {</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^_</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_prod'>prod</span><span class='op'>|</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_prod'>prod</span><span class='rbracket'>]</span>
      <span class='kw'>when</span> <span class='const'>Symbol</span><span class='comma'>,</span> <span class='const'>String</span>
        <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind1'>ind1</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prod'>prod</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_prod'>prod</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>when</span> <span class='const'>Array</span>
        <span class='id identifier rubyid_list'>list</span> <span class='op'>=</span> <span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_prod'>prod</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind2'>ind2</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind1'>ind1</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prod'>prod</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; [\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind2'>ind2</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_list'>list</span><span class='embexpr_end'>}</span><span class='tstring_content'>],</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>when</span> <span class='const'>Hash</span>
        <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind1'>ind1</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prod'>prod</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; {</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_prod'>prod</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^_</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_term'>term</span><span class='op'>|</span>
          <span class='id identifier rubyid_list'>list</span> <span class='op'>=</span> <span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_prod'>prod</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_term'>term</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind2'>ind2</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_term'>term</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_list'>list</span><span class='embexpr_end'>}</span><span class='tstring_content'>],</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind1'>ind1</span><span class='embexpr_end'>}</span><span class='tstring_content'>},</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>else</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unknown table entry type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_prod'>prod</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind0'>ind0</span><span class='embexpr_end'>}</span><span class='tstring_content'>}.freeze\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_table'>table</span>
    <span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind0'>ind0</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> = [\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind1'>ind1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^_</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind1'>ind1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ind0'>ind0</span><span class='embexpr_end'>}</span><span class='tstring_content'>].freeze\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_ruby_ll1-instance_method">
  
    #<strong>to_ruby_ll1</strong>(output, **options)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Output Ruby parser files for LL(1) parsing</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>output</span>
      
      
        <span class='type'>(<tt>IO</tt>, <tt>StringIO</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


398
399
400
401
402
403
404
405</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ebnf/ll1.rb', line 398</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_ruby_ll1'>to_ruby_ll1</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_outputTable'>outputTable</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BRANCH</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_branch'>branch</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_outputTable'>outputTable</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TERMINALS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_terminals'>terminals</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_outputTable'>outputTable</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FIRST</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_outputTable'>outputTable</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FOLLOW</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_follow'>follow</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_outputTable'>outputTable</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CLEANUP</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cleanup'>cleanup</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_outputTable'>outputTable</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PASS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pass'>pass</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_pass'>pass</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Sep  1 20:07:32 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.4).
</div>

    </div>
  </body>
</html>